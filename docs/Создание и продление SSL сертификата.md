# Инструкция по созданию wildcard сертификата *.dfv24.com в Nginx Proxy Manager и настройке автоматического продления SSL

---

## Шаг 1. Подготовка

- Убедитесь, что Nginx Proxy Manager (NPM) установлен и доступен по адресу http://192.168.10.14:81/
- У вас есть доступ к DNS-записям домена dfv24.com в панели управления reg.ru или у другого регистратора

---

## Шаг 2. Создание Wildcard SSL сертификата в Nginx Proxy Manager

1. Войдите в админку Nginx Proxy Manager по адресу http://192.168.10.14:81/

2. Перейдите в раздел **SSL Certificates** → нажмите кнопку **Add SSL Certificate**

3. Выберите пункт **Let's Encrypt**

4. Заполните поля:
   - **Domain Names:**  
     Введите `*.dfv24.com` — для wildcard сертификата  
     Также рекомендуется добавить основной домен `dfv24.com` (через запятую или в новом поле)  
   - **Email Address:**  
     Укажите ваш Email для уведомлений от Let's Encrypt (обязательно)  
   - **HTTP Challenge:**  
     Оставьте проверку HTTP, если NPM доступен из интернета по порту 80 и 443, или настройте DNS Challenge если поддерживается вашим DNS  

5. Отметьте галочку "Agree to the Let's Encrypt Terms of Service"

6. Нажмите **Save**

- NPM начнёт процесс получения сертификата с проверкой домена.  
- При успешном запросе сертификата вы увидите новый сертификат в списке.

---

## Шаг 3. Настройка автоматического продления

- Nginx Proxy Manager автоматически заботится о продлении сертификатов Let's Encrypt.  
- Для этого сервер должен быть доступен из интернета по портам 80 и 443, и DNS-записи правильно указывать на ваш сервер.  
- NPM периодически (обычно за 30 дней до окончания) запрашивает обновление сертификата.  
- В случае использования DNS Challenge необходимо чтобы в NPM была настроена интеграция с DNS провайдером (если поддерживается).

---

## Шаг 4. Использование wildcard сертификата в Proxy Hosts

1. Перейдите в **Proxy Hosts** → Создайте или отредактируйте запись прокси

2. В поле **Domain Names** укажите нужный поддомен из dfv24.com, например:  
   `api.dfv24.com` или `www.dfv24.com`

3. В разделе **SSL** выберите ваш wildcard сертификат `*.dfv24.com`, который вы получили на шаге 2

4. Включите опции:
   - Use SSL  
   - Force SSL  
   - HSTS (при необходимости)

5. Сохраните изменения.

---

## Шаг 5. Проверка

1. Проверьте, что для всех поддоменов используется единый сертификат  
2. Посетите https://api.dfv24.com или другие поддомены из браузера  
3. Убедитесь, что сертификат валиден, не просрочен и выдан на *.dfv24.com  
4. Проверяйте в разделе SSL Certificates статус продления сертификата

---

## Дополнительно

- Если Let's Encrypt не может выполнить HTTP Challenge из-за закрытого порта, настройте DNS Challenge (может потребоваться ключ API DNS провайдера)  
- Для безопасности и уведомлений держите Email в актуальном состоянии  
- Проверяйте логи Nginx Proxy Manager для выявления ошибок продления

---

# Итог

Nginx Proxy Manager позволяет легко получать и автоматически обновлять wildcard SSL сертификаты для домена *.dfv24.com с помощью Let's Encrypt.  
Главное — правильно настроить DNS записи и обеспечить интернет доступ на HTTP/HTTPS порты.  
Далее используйте один глобальный сертификат для всех ваших поддоменов через настройки Proxy Hosts.